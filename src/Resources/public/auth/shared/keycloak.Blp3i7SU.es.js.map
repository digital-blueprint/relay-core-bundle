{"version":3,"file":"keycloak.Blp3i7SU.es.js","sources":["../../../auth/node_modules/keycloak-js/lib/keycloak.js"],"sourcesContent":["/*\n * Copyright 2016 Red Hat, Inc. and/or its affiliates\n * and other contributors as indicated by the @author tags.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction Keycloak (config) {\n    if (!(this instanceof Keycloak)) {\n        throw new Error(\"The 'Keycloak' constructor must be invoked with 'new'.\")\n    }\n\n    if (typeof config !== 'string' && !isObject(config)) {\n        throw new Error(\"The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.\");\n    }\n\n    if (isObject(config)) {\n        const requiredProperties = 'oidcProvider' in config\n            ? ['clientId']\n            : ['url', 'realm', 'clientId'];\n\n        for (const property of requiredProperties) {\n            if (!config[property]) {\n                throw new Error(`The configuration object is missing the required '${property}' property.`);\n            }\n        }\n    }\n\n    var kc = this;\n    var adapter;\n    var refreshQueue = [];\n    var callbackStorage;\n\n    var loginIframe = {\n        enable: true,\n        callbackList: [],\n        interval: 5\n    };\n\n    kc.didInitialize = false;\n\n    var useNonce = true;\n    var logInfo = createLogger(console.info);\n    var logWarn = createLogger(console.warn);\n\n    if (!globalThis.isSecureContext) {\n        logWarn(\n            \"[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.\\n\" +\n            \"Continuing to run your application insecurely will lead to unexpected behavior and breakage.\\n\\n\" +\n            \"For more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\"\n        );\n    }\n\n    kc.init = function (initOptions = {}) {\n        if (kc.didInitialize) {\n            throw new Error(\"A 'Keycloak' instance can only be initialized once.\");\n        }\n\n        kc.didInitialize = true;\n\n        kc.authenticated = false;\n\n        callbackStorage = createCallbackStorage();\n        var adapters = ['default', 'cordova', 'cordova-native'];\n\n        if (adapters.indexOf(initOptions.adapter) > -1) {\n            adapter = loadAdapter(initOptions.adapter);\n        } else if (typeof initOptions.adapter === \"object\") {\n            adapter = initOptions.adapter;\n        } else {\n            if (window.Cordova || window.cordova) {\n                adapter = loadAdapter('cordova');\n            } else {\n                adapter = loadAdapter();\n            }\n        }\n\n        if (typeof initOptions.useNonce !== 'undefined') {\n            useNonce = initOptions.useNonce;\n        }\n\n        if (typeof initOptions.checkLoginIframe !== 'undefined') {\n            loginIframe.enable = initOptions.checkLoginIframe;\n        }\n\n        if (initOptions.checkLoginIframeInterval) {\n            loginIframe.interval = initOptions.checkLoginIframeInterval;\n        }\n\n        if (initOptions.onLoad === 'login-required') {\n            kc.loginRequired = true;\n        }\n\n        if (initOptions.responseMode) {\n            if (initOptions.responseMode === 'query' || initOptions.responseMode === 'fragment') {\n                kc.responseMode = initOptions.responseMode;\n            } else {\n                throw 'Invalid value for responseMode';\n            }\n        }\n\n        if (initOptions.flow) {\n            switch (initOptions.flow) {\n                case 'standard':\n                    kc.responseType = 'code';\n                    break;\n                case 'implicit':\n                    kc.responseType = 'id_token token';\n                    break;\n                case 'hybrid':\n                    kc.responseType = 'code id_token token';\n                    break;\n                default:\n                    throw 'Invalid value for flow';\n            }\n            kc.flow = initOptions.flow;\n        }\n\n        if (initOptions.timeSkew != null) {\n            kc.timeSkew = initOptions.timeSkew;\n        }\n\n        if(initOptions.redirectUri) {\n            kc.redirectUri = initOptions.redirectUri;\n        }\n\n        if (initOptions.silentCheckSsoRedirectUri) {\n            kc.silentCheckSsoRedirectUri = initOptions.silentCheckSsoRedirectUri;\n        }\n\n        if (typeof initOptions.silentCheckSsoFallback === 'boolean') {\n            kc.silentCheckSsoFallback = initOptions.silentCheckSsoFallback;\n        } else {\n            kc.silentCheckSsoFallback = true;\n        }\n\n        if (typeof initOptions.pkceMethod !== \"undefined\") {\n            if (initOptions.pkceMethod !== \"S256\" && initOptions.pkceMethod !== false) {\n                throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${initOptions.pkceMethod}.`);\n            }\n\n            kc.pkceMethod = initOptions.pkceMethod;\n        } else {\n            kc.pkceMethod = \"S256\";\n        }\n\n        if (typeof initOptions.enableLogging === 'boolean') {\n            kc.enableLogging = initOptions.enableLogging;\n        } else {\n            kc.enableLogging = false;\n        }\n\n        if (initOptions.logoutMethod === 'POST') {\n            kc.logoutMethod = 'POST';\n        } else {\n            kc.logoutMethod = 'GET';\n        }\n\n        if (typeof initOptions.scope === 'string') {\n            kc.scope = initOptions.scope;\n        }\n\n        if (typeof initOptions.acrValues === 'string') {\n            kc.acrValues = initOptions.acrValues;\n        }\n\n        if (typeof initOptions.messageReceiveTimeout === 'number' && initOptions.messageReceiveTimeout > 0) {\n            kc.messageReceiveTimeout = initOptions.messageReceiveTimeout;\n        } else {\n            kc.messageReceiveTimeout = 10000;\n        }\n\n        if (!kc.responseMode) {\n            kc.responseMode = 'fragment';\n        }\n        if (!kc.responseType) {\n            kc.responseType = 'code';\n            kc.flow = 'standard';\n        }\n\n        var promise = createPromise();\n\n        var initPromise = createPromise();\n        initPromise.promise.then(function() {\n            kc.onReady && kc.onReady(kc.authenticated);\n            promise.setSuccess(kc.authenticated);\n        }).catch(function(error) {\n            promise.setError(error);\n        });\n\n        var configPromise = loadConfig();\n\n        function onLoad() {\n            var doLogin = function(prompt) {\n                if (!prompt) {\n                    options.prompt = 'none';\n                }\n\n                if (initOptions.locale) {\n                    options.locale = initOptions.locale;\n                }\n                kc.login(options).then(function () {\n                    initPromise.setSuccess();\n                }).catch(function (error) {\n                    initPromise.setError(error);\n                });\n            }\n\n            var checkSsoSilently = async function() {\n                var ifrm = document.createElement(\"iframe\");\n                var src = await kc.createLoginUrl({prompt: 'none', redirectUri: kc.silentCheckSsoRedirectUri});\n                ifrm.setAttribute(\"src\", src);\n                ifrm.setAttribute(\"sandbox\", \"allow-storage-access-by-user-activation allow-scripts allow-same-origin\");\n                ifrm.setAttribute(\"title\", \"keycloak-silent-check-sso\");\n                ifrm.style.display = \"none\";\n                document.body.appendChild(ifrm);\n\n                var messageCallback = function(event) {\n                    if (event.origin !== window.location.origin || ifrm.contentWindow !== event.source) {\n                        return;\n                    }\n\n                    var oauth = parseCallback(event.data);\n                    processCallback(oauth, initPromise);\n\n                    document.body.removeChild(ifrm);\n                    window.removeEventListener(\"message\", messageCallback);\n                };\n\n                window.addEventListener(\"message\", messageCallback);\n            };\n\n            var options = {};\n            switch (initOptions.onLoad) {\n                case 'check-sso':\n                    if (loginIframe.enable) {\n                        setupCheckLoginIframe().then(function() {\n                            checkLoginIframe().then(function (unchanged) {\n                                if (!unchanged) {\n                                    kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\n                                } else {\n                                    initPromise.setSuccess();\n                                }\n                            }).catch(function (error) {\n                                initPromise.setError(error);\n                            });\n                        });\n                    } else {\n                        kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\n                    }\n                    break;\n                case 'login-required':\n                    doLogin(true);\n                    break;\n                default:\n                    throw 'Invalid value for onLoad';\n            }\n        }\n\n        function processInit() {\n            var callback = parseCallback(window.location.href);\n\n            if (callback) {\n                window.history.replaceState(window.history.state, null, callback.newUrl);\n            }\n\n            if (callback && callback.valid) {\n                return setupCheckLoginIframe().then(function() {\n                    processCallback(callback, initPromise);\n                }).catch(function (error) {\n                    initPromise.setError(error);\n                });\n            }\n\n            if (initOptions.token && initOptions.refreshToken) {\n                setToken(initOptions.token, initOptions.refreshToken, initOptions.idToken);\n\n                if (loginIframe.enable) {\n                    setupCheckLoginIframe().then(function() {\n                        checkLoginIframe().then(function (unchanged) {\n                            if (unchanged) {\n                                kc.onAuthSuccess && kc.onAuthSuccess();\n                                initPromise.setSuccess();\n                                scheduleCheckIframe();\n                            } else {\n                                initPromise.setSuccess();\n                            }\n                        }).catch(function (error) {\n                            initPromise.setError(error);\n                        });\n                    });\n                } else {\n                    kc.updateToken(-1).then(function() {\n                        kc.onAuthSuccess && kc.onAuthSuccess();\n                        initPromise.setSuccess();\n                    }).catch(function(error) {\n                        kc.onAuthError && kc.onAuthError();\n                        if (initOptions.onLoad) {\n                            onLoad();\n                        } else {\n                            initPromise.setError(error);\n                        }\n                    });\n                }\n            } else if (initOptions.onLoad) {\n                onLoad();\n            } else {\n                initPromise.setSuccess();\n            }\n        }\n\n        configPromise.then(function () {\n            check3pCookiesSupported()\n                .then(processInit)\n                .catch(function (error) {\n                    promise.setError(error);\n                });\n        });\n        configPromise.catch(function (error) {\n            promise.setError(error);\n        });\n\n        return promise.promise;\n    }\n\n    kc.login = function (options) {\n        return adapter.login(options);\n    }\n\n    function generateRandomData(len) {\n        if (typeof crypto === \"undefined\" || typeof crypto.getRandomValues === \"undefined\") {\n            throw new Error(\"Web Crypto API is not available.\");\n        }\n\n        return crypto.getRandomValues(new Uint8Array(len));\n    }\n\n    function generateCodeVerifier(len) {\n        return generateRandomString(len, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789');\n    }\n\n    function generateRandomString(len, alphabet){\n        var randomData = generateRandomData(len);\n        var chars = new Array(len);\n        for (var i = 0; i < len; i++) {\n            chars[i] = alphabet.charCodeAt(randomData[i] % alphabet.length);\n        }\n        return String.fromCharCode.apply(null, chars);\n    }\n\n    async function generatePkceChallenge(pkceMethod, codeVerifier) {\n        if (pkceMethod !== \"S256\") {\n            throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${pkceMethod}'.`);\n        }\n\n        // hash codeVerifier, then encode as url-safe base64 without padding\n        const hashBytes = new Uint8Array(await sha256Digest(codeVerifier));\n        const encodedHash = bytesToBase64(hashBytes)\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/\\=/g, '');\n\n        return encodedHash;\n    }\n\n    function buildClaimsParameter(requestedAcr){\n        var claims = {\n            id_token: {\n                acr: requestedAcr\n            }\n        }\n        return JSON.stringify(claims);\n    }\n\n    kc.createLoginUrl = async function(options) {\n        var state = createUUID();\n        var nonce = createUUID();\n\n        var redirectUri = adapter.redirectUri(options);\n\n        var callbackState = {\n            state: state,\n            nonce: nonce,\n            redirectUri: encodeURIComponent(redirectUri),\n            loginOptions: options\n        };\n\n        if (options && options.prompt) {\n            callbackState.prompt = options.prompt;\n        }\n\n        var baseUrl;\n        if (options && options.action == 'register') {\n            baseUrl = kc.endpoints.register();\n        } else {\n            baseUrl = kc.endpoints.authorize();\n        }\n\n        var scope = options && options.scope || kc.scope;\n        if (!scope) {\n            // if scope is not set, default to \"openid\"\n            scope = \"openid\";\n        } else if (scope.indexOf(\"openid\") === -1) {\n            // if openid scope is missing, prefix the given scopes with it\n            scope = \"openid \" + scope;\n        }\n\n        var url = baseUrl\n            + '?client_id=' + encodeURIComponent(kc.clientId)\n            + '&redirect_uri=' + encodeURIComponent(redirectUri)\n            + '&state=' + encodeURIComponent(state)\n            + '&response_mode=' + encodeURIComponent(kc.responseMode)\n            + '&response_type=' + encodeURIComponent(kc.responseType)\n            + '&scope=' + encodeURIComponent(scope);\n        if (useNonce) {\n            url = url + '&nonce=' + encodeURIComponent(nonce);\n        }\n\n        if (options && options.prompt) {\n            url += '&prompt=' + encodeURIComponent(options.prompt);\n        }\n\n        if (options && typeof options.maxAge === 'number') {\n            url += '&max_age=' + encodeURIComponent(options.maxAge);\n        }\n\n        if (options && options.loginHint) {\n            url += '&login_hint=' + encodeURIComponent(options.loginHint);\n        }\n\n        if (options && options.idpHint) {\n            url += '&kc_idp_hint=' + encodeURIComponent(options.idpHint);\n        }\n\n        if (options && options.action && options.action != 'register') {\n            url += '&kc_action=' + encodeURIComponent(options.action);\n        }\n\n        if (options && options.locale) {\n            url += '&ui_locales=' + encodeURIComponent(options.locale);\n        }\n\n        if (options && options.acr) {\n            var claimsParameter = buildClaimsParameter(options.acr);\n            url += '&claims=' + encodeURIComponent(claimsParameter);\n        }\n\n        if ((options && options.acrValues) || kc.acrValues) {\n            url += '&acr_values=' + encodeURIComponent(options.acrValues || kc.acrValues);\n        }\n\n        if (kc.pkceMethod) {\n            try {\n                const codeVerifier = generateCodeVerifier(96);\n                const pkceChallenge = await generatePkceChallenge(kc.pkceMethod, codeVerifier);\n\n                callbackState.pkceCodeVerifier = codeVerifier;\n\n                url += '&code_challenge=' + pkceChallenge;\n                url += '&code_challenge_method=' + kc.pkceMethod;\n            } catch (error) {\n                throw new Error(\"Failed to generate PKCE challenge.\", { cause: error });\n            }\n        }\n\n        callbackStorage.add(callbackState);\n\n        return url;\n    }\n\n    kc.logout = function(options) {\n        return adapter.logout(options);\n    }\n\n    kc.createLogoutUrl = function(options) {\n\n        const logoutMethod = options?.logoutMethod ?? kc.logoutMethod;\n        if (logoutMethod === 'POST') {\n            return kc.endpoints.logout();\n        }\n\n        var url = kc.endpoints.logout()\n            + '?client_id=' + encodeURIComponent(kc.clientId)\n            + '&post_logout_redirect_uri=' + encodeURIComponent(adapter.redirectUri(options, false));\n\n        if (kc.idToken) {\n            url += '&id_token_hint=' + encodeURIComponent(kc.idToken);\n        }\n\n        return url;\n    }\n\n    kc.register = function (options) {\n        return adapter.register(options);\n    }\n\n    kc.createRegisterUrl = async function(options) {\n        if (!options) {\n            options = {};\n        }\n        options.action = 'register';\n        return await kc.createLoginUrl(options);\n    }\n\n    kc.createAccountUrl = function(options) {\n        var realm = getRealmUrl();\n        var url = undefined;\n        if (typeof realm !== 'undefined') {\n            url = realm\n            + '/account'\n            + '?referrer=' + encodeURIComponent(kc.clientId)\n            + '&referrer_uri=' + encodeURIComponent(adapter.redirectUri(options));\n        }\n        return url;\n    }\n\n    kc.accountManagement = function() {\n        return adapter.accountManagement();\n    }\n\n    kc.hasRealmRole = function (role) {\n        var access = kc.realmAccess;\n        return !!access && access.roles.indexOf(role) >= 0;\n    }\n\n    kc.hasResourceRole = function(role, resource) {\n        if (!kc.resourceAccess) {\n            return false;\n        }\n\n        var access = kc.resourceAccess[resource || kc.clientId];\n        return !!access && access.roles.indexOf(role) >= 0;\n    }\n\n    kc.loadUserProfile = function() {\n        var url = getRealmUrl() + '/account';\n        var req = new XMLHttpRequest();\n        req.open('GET', url, true);\n        req.setRequestHeader('Accept', 'application/json');\n        req.setRequestHeader('Authorization', 'bearer ' + kc.token);\n\n        var promise = createPromise();\n\n        req.onreadystatechange = function () {\n            if (req.readyState == 4) {\n                if (req.status == 200) {\n                    kc.profile = JSON.parse(req.responseText);\n                    promise.setSuccess(kc.profile);\n                } else {\n                    promise.setError();\n                }\n            }\n        }\n\n        req.send();\n\n        return promise.promise;\n    }\n\n    kc.loadUserInfo = function() {\n        var url = kc.endpoints.userinfo();\n        var req = new XMLHttpRequest();\n        req.open('GET', url, true);\n        req.setRequestHeader('Accept', 'application/json');\n        req.setRequestHeader('Authorization', 'bearer ' + kc.token);\n\n        var promise = createPromise();\n\n        req.onreadystatechange = function () {\n            if (req.readyState == 4) {\n                if (req.status == 200) {\n                    kc.userInfo = JSON.parse(req.responseText);\n                    promise.setSuccess(kc.userInfo);\n                } else {\n                    promise.setError();\n                }\n            }\n        }\n\n        req.send();\n\n        return promise.promise;\n    }\n\n    kc.isTokenExpired = function(minValidity) {\n        if (!kc.tokenParsed || (!kc.refreshToken && kc.flow != 'implicit' )) {\n            throw 'Not authenticated';\n        }\n\n        if (kc.timeSkew == null) {\n            logInfo('[KEYCLOAK] Unable to determine if token is expired as timeskew is not set');\n            return true;\n        }\n\n        var expiresIn = kc.tokenParsed['exp'] - Math.ceil(new Date().getTime() / 1000) + kc.timeSkew;\n        if (minValidity) {\n            if (isNaN(minValidity)) {\n                throw 'Invalid minValidity';\n            }\n            expiresIn -= minValidity;\n        }\n        return expiresIn < 0;\n    }\n\n    kc.updateToken = function(minValidity) {\n        var promise = createPromise();\n\n        if (!kc.refreshToken) {\n            promise.setError();\n            return promise.promise;\n        }\n\n        minValidity = minValidity || 5;\n\n        var exec = function() {\n            var refreshToken = false;\n            if (minValidity == -1) {\n                refreshToken = true;\n                logInfo('[KEYCLOAK] Refreshing token: forced refresh');\n            } else if (!kc.tokenParsed || kc.isTokenExpired(minValidity)) {\n                refreshToken = true;\n                logInfo('[KEYCLOAK] Refreshing token: token expired');\n            }\n\n            if (!refreshToken) {\n                promise.setSuccess(false);\n            } else {\n                var params = 'grant_type=refresh_token&' + 'refresh_token=' + kc.refreshToken;\n                var url = kc.endpoints.token();\n\n                refreshQueue.push(promise);\n\n                if (refreshQueue.length == 1) {\n                    var req = new XMLHttpRequest();\n                    req.open('POST', url, true);\n                    req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n                    req.withCredentials = true;\n\n                    params += '&client_id=' + encodeURIComponent(kc.clientId);\n\n                    var timeLocal = new Date().getTime();\n\n                    req.onreadystatechange = function () {\n                        if (req.readyState == 4) {\n                            if (req.status == 200) {\n                                logInfo('[KEYCLOAK] Token refreshed');\n\n                                timeLocal = (timeLocal + new Date().getTime()) / 2;\n\n                                var tokenResponse = JSON.parse(req.responseText);\n\n                                setToken(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], timeLocal);\n\n                                kc.onAuthRefreshSuccess && kc.onAuthRefreshSuccess();\n                                for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\n                                    p.setSuccess(true);\n                                }\n                            } else {\n                                logWarn('[KEYCLOAK] Failed to refresh token');\n\n                                if (req.status == 400) {\n                                    kc.clearToken();\n                                }\n\n                                kc.onAuthRefreshError && kc.onAuthRefreshError();\n                                for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\n                                    p.setError(true);\n                                }\n                            }\n                        }\n                    };\n\n                    req.send(params);\n                }\n            }\n        }\n\n        if (loginIframe.enable) {\n            var iframePromise = checkLoginIframe();\n            iframePromise.then(function() {\n                exec();\n            }).catch(function(error) {\n                promise.setError(error);\n            });\n        } else {\n            exec();\n        }\n\n        return promise.promise;\n    }\n\n    kc.clearToken = function() {\n        if (kc.token) {\n            setToken(null, null, null);\n            kc.onAuthLogout && kc.onAuthLogout();\n            if (kc.loginRequired) {\n                kc.login();\n            }\n        }\n    }\n\n    function getRealmUrl() {\n        if (typeof kc.authServerUrl !== 'undefined') {\n            if (kc.authServerUrl.charAt(kc.authServerUrl.length - 1) == '/') {\n                return kc.authServerUrl + 'realms/' + encodeURIComponent(kc.realm);\n            } else {\n                return kc.authServerUrl + '/realms/' + encodeURIComponent(kc.realm);\n            }\n        } else {\n            return undefined;\n        }\n    }\n\n    function getOrigin() {\n        if (!window.location.origin) {\n            return window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? ':' + window.location.port: '');\n        } else {\n            return window.location.origin;\n        }\n    }\n\n    function processCallback(oauth, promise) {\n        var code = oauth.code;\n        var error = oauth.error;\n        var prompt = oauth.prompt;\n\n        var timeLocal = new Date().getTime();\n\n        if (oauth['kc_action_status']) {\n            kc.onActionUpdate && kc.onActionUpdate(oauth['kc_action_status'], oauth['kc_action']);\n        }\n\n        if (error) {\n            if (prompt != 'none') {\n                if (oauth.error_description && oauth.error_description === \"authentication_expired\") {\n                    kc.login(oauth.loginOptions);\n                } else {\n                    var errorData = { error: error, error_description: oauth.error_description };\n                    kc.onAuthError && kc.onAuthError(errorData);\n                    promise && promise.setError(errorData);\n                }\n            } else {\n                promise && promise.setSuccess();\n            }\n            return;\n        } else if ((kc.flow != 'standard') && (oauth.access_token || oauth.id_token)) {\n            authSuccess(oauth.access_token, null, oauth.id_token, true);\n        }\n\n        if ((kc.flow != 'implicit') && code) {\n            var params = 'code=' + code + '&grant_type=authorization_code';\n            var url = kc.endpoints.token();\n\n            var req = new XMLHttpRequest();\n            req.open('POST', url, true);\n            req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\n            params += '&client_id=' + encodeURIComponent(kc.clientId);\n            params += '&redirect_uri=' + oauth.redirectUri;\n\n            if (oauth.pkceCodeVerifier) {\n                params += '&code_verifier=' + oauth.pkceCodeVerifier;\n            }\n\n            req.withCredentials = true;\n\n            req.onreadystatechange = function() {\n                if (req.readyState == 4) {\n                    if (req.status == 200) {\n\n                        var tokenResponse = JSON.parse(req.responseText);\n                        authSuccess(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], kc.flow === 'standard');\n                        scheduleCheckIframe();\n                    } else {\n                        kc.onAuthError && kc.onAuthError();\n                        promise && promise.setError();\n                    }\n                }\n            };\n\n            req.send(params);\n        }\n\n        function authSuccess(accessToken, refreshToken, idToken, fulfillPromise) {\n            timeLocal = (timeLocal + new Date().getTime()) / 2;\n\n            setToken(accessToken, refreshToken, idToken, timeLocal);\n\n            if (useNonce && (kc.idTokenParsed && kc.idTokenParsed.nonce != oauth.storedNonce)) {\n                logInfo('[KEYCLOAK] Invalid nonce, clearing token');\n                kc.clearToken();\n                promise && promise.setError();\n            } else {\n                if (fulfillPromise) {\n                    kc.onAuthSuccess && kc.onAuthSuccess();\n                    promise && promise.setSuccess();\n                }\n            }\n        }\n\n    }\n\n    function loadConfig() {\n        var promise = createPromise();\n        var configUrl;\n\n        if (typeof config === 'string') {\n            configUrl = config;\n        }\n\n        function setupOidcEndoints(oidcConfiguration) {\n            if (! oidcConfiguration) {\n                kc.endpoints = {\n                    authorize: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/auth';\n                    },\n                    token: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/token';\n                    },\n                    logout: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/logout';\n                    },\n                    checkSessionIframe: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/login-status-iframe.html';\n                    },\n                    thirdPartyCookiesIframe: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/3p-cookies/step1.html';\n                    },\n                    register: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/registrations';\n                    },\n                    userinfo: function() {\n                        return getRealmUrl() + '/protocol/openid-connect/userinfo';\n                    }\n                };\n            } else {\n                kc.endpoints = {\n                    authorize: function() {\n                        return oidcConfiguration.authorization_endpoint;\n                    },\n                    token: function() {\n                        return oidcConfiguration.token_endpoint;\n                    },\n                    logout: function() {\n                        if (!oidcConfiguration.end_session_endpoint) {\n                            throw \"Not supported by the OIDC server\";\n                        }\n                        return oidcConfiguration.end_session_endpoint;\n                    },\n                    checkSessionIframe: function() {\n                        if (!oidcConfiguration.check_session_iframe) {\n                            throw \"Not supported by the OIDC server\";\n                        }\n                        return oidcConfiguration.check_session_iframe;\n                    },\n                    register: function() {\n                        throw 'Redirection to \"Register user\" page not supported in standard OIDC mode';\n                    },\n                    userinfo: function() {\n                        if (!oidcConfiguration.userinfo_endpoint) {\n                            throw \"Not supported by the OIDC server\";\n                        }\n                        return oidcConfiguration.userinfo_endpoint;\n                    }\n                }\n            }\n        }\n\n        if (configUrl) {\n            var req = new XMLHttpRequest();\n            req.open('GET', configUrl, true);\n            req.setRequestHeader('Accept', 'application/json');\n\n            req.onreadystatechange = function () {\n                if (req.readyState == 4) {\n                    if (req.status == 200 || fileLoaded(req)) {\n                        var config = JSON.parse(req.responseText);\n\n                        kc.authServerUrl = config['auth-server-url'];\n                        kc.realm = config['realm'];\n                        kc.clientId = config['resource'];\n                        setupOidcEndoints(null);\n                        promise.setSuccess();\n                    } else {\n                        promise.setError();\n                    }\n                }\n            };\n\n            req.send();\n        } else {\n            kc.clientId = config.clientId;\n\n            var oidcProvider = config['oidcProvider'];\n            if (!oidcProvider) {\n                kc.authServerUrl = config.url;\n                kc.realm = config.realm;\n                setupOidcEndoints(null);\n                promise.setSuccess();\n            } else {\n                if (typeof oidcProvider === 'string') {\n                    var oidcProviderConfigUrl;\n                    if (oidcProvider.charAt(oidcProvider.length - 1) == '/') {\n                        oidcProviderConfigUrl = oidcProvider + '.well-known/openid-configuration';\n                    } else {\n                        oidcProviderConfigUrl = oidcProvider + '/.well-known/openid-configuration';\n                    }\n                    var req = new XMLHttpRequest();\n                    req.open('GET', oidcProviderConfigUrl, true);\n                    req.setRequestHeader('Accept', 'application/json');\n\n                    req.onreadystatechange = function () {\n                        if (req.readyState == 4) {\n                            if (req.status == 200 || fileLoaded(req)) {\n                                var oidcProviderConfig = JSON.parse(req.responseText);\n                                setupOidcEndoints(oidcProviderConfig);\n                                promise.setSuccess();\n                            } else {\n                                promise.setError();\n                            }\n                        }\n                    };\n\n                    req.send();\n                } else {\n                    setupOidcEndoints(oidcProvider);\n                    promise.setSuccess();\n                }\n            }\n        }\n\n        return promise.promise;\n    }\n\n    function fileLoaded(xhr) {\n        return xhr.status == 0 && xhr.responseText && xhr.responseURL.startsWith('file:');\n    }\n\n    function setToken(token, refreshToken, idToken, timeLocal) {\n        if (kc.tokenTimeoutHandle) {\n            clearTimeout(kc.tokenTimeoutHandle);\n            kc.tokenTimeoutHandle = null;\n        }\n\n        if (refreshToken) {\n            kc.refreshToken = refreshToken;\n            kc.refreshTokenParsed = decodeToken(refreshToken);\n        } else {\n            delete kc.refreshToken;\n            delete kc.refreshTokenParsed;\n        }\n\n        if (idToken) {\n            kc.idToken = idToken;\n            kc.idTokenParsed = decodeToken(idToken);\n        } else {\n            delete kc.idToken;\n            delete kc.idTokenParsed;\n        }\n\n        if (token) {\n            kc.token = token;\n            kc.tokenParsed = decodeToken(token);\n            kc.sessionId = kc.tokenParsed.sid;\n            kc.authenticated = true;\n            kc.subject = kc.tokenParsed.sub;\n            kc.realmAccess = kc.tokenParsed.realm_access;\n            kc.resourceAccess = kc.tokenParsed.resource_access;\n\n            if (timeLocal) {\n                kc.timeSkew = Math.floor(timeLocal / 1000) - kc.tokenParsed.iat;\n            }\n\n            if (kc.timeSkew != null) {\n                logInfo('[KEYCLOAK] Estimated time difference between browser and server is ' + kc.timeSkew + ' seconds');\n\n                if (kc.onTokenExpired) {\n                    var expiresIn = (kc.tokenParsed['exp'] - (new Date().getTime() / 1000) + kc.timeSkew) * 1000;\n                    logInfo('[KEYCLOAK] Token expires in ' + Math.round(expiresIn / 1000) + ' s');\n                    if (expiresIn <= 0) {\n                        kc.onTokenExpired();\n                    } else {\n                        kc.tokenTimeoutHandle = setTimeout(kc.onTokenExpired, expiresIn);\n                    }\n                }\n            }\n        } else {\n            delete kc.token;\n            delete kc.tokenParsed;\n            delete kc.subject;\n            delete kc.realmAccess;\n            delete kc.resourceAccess;\n\n            kc.authenticated = false;\n        }\n    }\n\n    function createUUID() {\n        if (typeof crypto === \"undefined\" || typeof crypto.randomUUID === \"undefined\") {\n            throw new Error(\"Web Crypto API is not available.\");\n        }\n\n        return crypto.randomUUID();\n    }\n\n    function parseCallback(url) {\n        var oauth = parseCallbackUrl(url);\n        if (!oauth) {\n            return;\n        }\n\n        var oauthState = callbackStorage.get(oauth.state);\n\n        if (oauthState) {\n            oauth.valid = true;\n            oauth.redirectUri = oauthState.redirectUri;\n            oauth.storedNonce = oauthState.nonce;\n            oauth.prompt = oauthState.prompt;\n            oauth.pkceCodeVerifier = oauthState.pkceCodeVerifier;\n            oauth.loginOptions = oauthState.loginOptions;\n        }\n\n        return oauth;\n    }\n\n    function parseCallbackUrl(url) {\n        var supportedParams;\n        switch (kc.flow) {\n            case 'standard':\n                supportedParams = ['code', 'state', 'session_state', 'kc_action_status', 'kc_action', 'iss'];\n                break;\n            case 'implicit':\n                supportedParams = ['access_token', 'token_type', 'id_token', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss'];\n                break;\n            case 'hybrid':\n                supportedParams = ['access_token', 'token_type', 'id_token', 'code', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss'];\n                break;\n        }\n\n        supportedParams.push('error');\n        supportedParams.push('error_description');\n        supportedParams.push('error_uri');\n\n        var queryIndex = url.indexOf('?');\n        var fragmentIndex = url.indexOf('#');\n\n        var newUrl;\n        var parsed;\n\n        if (kc.responseMode === 'query' && queryIndex !== -1) {\n            newUrl = url.substring(0, queryIndex);\n            parsed = parseCallbackParams(url.substring(queryIndex + 1, fragmentIndex !== -1 ? fragmentIndex : url.length), supportedParams);\n            if (parsed.paramsString !== '') {\n                newUrl += '?' + parsed.paramsString;\n            }\n            if (fragmentIndex !== -1) {\n                newUrl += url.substring(fragmentIndex);\n            }\n        } else if (kc.responseMode === 'fragment' && fragmentIndex !== -1) {\n            newUrl = url.substring(0, fragmentIndex);\n            parsed = parseCallbackParams(url.substring(fragmentIndex + 1), supportedParams);\n            if (parsed.paramsString !== '') {\n                newUrl += '#' + parsed.paramsString;\n            }\n        }\n\n        if (parsed && parsed.oauthParams) {\n            if (kc.flow === 'standard' || kc.flow === 'hybrid') {\n                if ((parsed.oauthParams.code || parsed.oauthParams.error) && parsed.oauthParams.state) {\n                    parsed.oauthParams.newUrl = newUrl;\n                    return parsed.oauthParams;\n                }\n            } else if (kc.flow === 'implicit') {\n                if ((parsed.oauthParams.access_token || parsed.oauthParams.error) && parsed.oauthParams.state) {\n                    parsed.oauthParams.newUrl = newUrl;\n                    return parsed.oauthParams;\n                }\n            }\n        }\n    }\n\n    function parseCallbackParams(paramsString, supportedParams) {\n        var p = paramsString.split('&');\n        var result = {\n            paramsString: '',\n            oauthParams: {}\n        }\n        for (var i = 0; i < p.length; i++) {\n            var split = p[i].indexOf(\"=\");\n            var key = p[i].slice(0, split);\n            if (supportedParams.indexOf(key) !== -1) {\n                result.oauthParams[key] = p[i].slice(split + 1);\n            } else {\n                if (result.paramsString !== '') {\n                    result.paramsString += '&';\n                }\n                result.paramsString += p[i];\n            }\n        }\n        return result;\n    }\n\n    function createPromise() {\n        // Need to create a native Promise which also preserves the\n        // interface of the custom promise type previously used by the API\n        var p = {\n            setSuccess: function(result) {\n                p.resolve(result);\n            },\n\n            setError: function(result) {\n                p.reject(result);\n            }\n        };\n        p.promise = new Promise(function(resolve, reject) {\n            p.resolve = resolve;\n            p.reject = reject;\n        });\n\n        return p;\n    }\n\n    // Function to extend existing native Promise with timeout\n    function applyTimeoutToPromise(promise, timeout, errorMessage) {\n        var timeoutHandle = null;\n        var timeoutPromise = new Promise(function (resolve, reject) {\n            timeoutHandle = setTimeout(function () {\n                reject({ \"error\": errorMessage || \"Promise is not settled within timeout of \" + timeout + \"ms\" });\n            }, timeout);\n        });\n\n        return Promise.race([promise, timeoutPromise]).finally(function () {\n            clearTimeout(timeoutHandle);\n        });\n    }\n\n    function setupCheckLoginIframe() {\n        var promise = createPromise();\n\n        if (!loginIframe.enable) {\n            promise.setSuccess();\n            return promise.promise;\n        }\n\n        if (loginIframe.iframe) {\n            promise.setSuccess();\n            return promise.promise;\n        }\n\n        var iframe = document.createElement('iframe');\n        loginIframe.iframe = iframe;\n\n        iframe.onload = function() {\n            var authUrl = kc.endpoints.authorize();\n            if (authUrl.charAt(0) === '/') {\n                loginIframe.iframeOrigin = getOrigin();\n            } else {\n                loginIframe.iframeOrigin = authUrl.substring(0, authUrl.indexOf('/', 8));\n            }\n            promise.setSuccess();\n        }\n\n        var src = kc.endpoints.checkSessionIframe();\n        iframe.setAttribute('src', src );\n        iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin');\n        iframe.setAttribute('title', 'keycloak-session-iframe' );\n        iframe.style.display = 'none';\n        document.body.appendChild(iframe);\n\n        var messageCallback = function(event) {\n            if ((event.origin !== loginIframe.iframeOrigin) || (loginIframe.iframe.contentWindow !== event.source)) {\n                return;\n            }\n\n            if (!(event.data == 'unchanged' || event.data == 'changed' || event.data == 'error')) {\n                return;\n            }\n\n\n            if (event.data != 'unchanged') {\n                kc.clearToken();\n            }\n\n            var callbacks = loginIframe.callbackList.splice(0, loginIframe.callbackList.length);\n\n            for (var i = callbacks.length - 1; i >= 0; --i) {\n                var promise = callbacks[i];\n                if (event.data == 'error') {\n                    promise.setError();\n                } else {\n                    promise.setSuccess(event.data == 'unchanged');\n                }\n            }\n        };\n\n        window.addEventListener('message', messageCallback, false);\n\n        return promise.promise;\n    }\n\n    function scheduleCheckIframe() {\n        if (loginIframe.enable) {\n            if (kc.token) {\n                setTimeout(function() {\n                    checkLoginIframe().then(function(unchanged) {\n                        if (unchanged) {\n                            scheduleCheckIframe();\n                        }\n                    });\n                }, loginIframe.interval * 1000);\n            }\n        }\n    }\n\n    function checkLoginIframe() {\n        var promise = createPromise();\n\n        if (loginIframe.iframe && loginIframe.iframeOrigin ) {\n            var msg = kc.clientId + ' ' + (kc.sessionId ? kc.sessionId : '');\n            loginIframe.callbackList.push(promise);\n            var origin = loginIframe.iframeOrigin;\n            if (loginIframe.callbackList.length == 1) {\n                loginIframe.iframe.contentWindow.postMessage(msg, origin);\n            }\n        } else {\n            promise.setSuccess();\n        }\n\n        return promise.promise;\n    }\n\n    function check3pCookiesSupported() {\n        var promise = createPromise();\n\n        if ((loginIframe.enable || kc.silentCheckSsoRedirectUri) && typeof kc.endpoints.thirdPartyCookiesIframe === 'function') {\n            var iframe = document.createElement('iframe');\n            iframe.setAttribute('src', kc.endpoints.thirdPartyCookiesIframe());\n            iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin');\n            iframe.setAttribute('title', 'keycloak-3p-check-iframe' );\n            iframe.style.display = 'none';\n            document.body.appendChild(iframe);\n\n            var messageCallback = function(event) {\n                if (iframe.contentWindow !== event.source) {\n                    return;\n                }\n\n                if (event.data !== \"supported\" && event.data !== \"unsupported\") {\n                    return;\n                } else if (event.data === \"unsupported\") {\n                    logWarn(\n                        \"[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\\n\\n\" +\n                        \" - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\\n\" +\n                        \" - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\\n\\n\" +\n                        \"For more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers\"\n                    );\n\n                    loginIframe.enable = false;\n                    if (kc.silentCheckSsoFallback) {\n                        kc.silentCheckSsoRedirectUri = false;\n                    }\n                }\n\n                document.body.removeChild(iframe);\n                window.removeEventListener(\"message\", messageCallback);\n                promise.setSuccess();\n            };\n\n            window.addEventListener('message', messageCallback, false);\n        } else {\n            promise.setSuccess();\n        }\n\n        return applyTimeoutToPromise(promise.promise, kc.messageReceiveTimeout, \"Timeout when waiting for 3rd party check iframe message.\");\n    }\n\n    function loadAdapter(type) {\n        if (!type || type == 'default') {\n            return {\n                login: async function(options) {\n                    window.location.assign(await kc.createLoginUrl(options));\n                    return createPromise().promise;\n                },\n\n                logout: async function(options) {\n\n                    const logoutMethod = options?.logoutMethod ?? kc.logoutMethod;\n                    if (logoutMethod === \"GET\") {\n                        window.location.replace(kc.createLogoutUrl(options));\n                        return;\n                    }\n\n                    const logoutUrl = kc.createLogoutUrl(options);\n                    const response = await fetch(logoutUrl, {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/x-www-form-urlencoded\"\n                        },\n                        body: new URLSearchParams({\n                            id_token_hint: kc.idToken,\n                            client_id: kc.clientId,\n                            post_logout_redirect_uri: adapter.redirectUri(options, false)\n                        })\n                    });\n\n                    if (response.redirected) {\n                        window.location.href = response.url;\n                        return;\n                    }\n\n                    if (response.ok) {\n                        window.location.reload();\n                        return;\n                    }\n\n                    throw new Error(\"Logout failed, request returned an error code.\");\n                },\n\n                register: async function(options) {\n                    window.location.assign(await kc.createRegisterUrl(options));\n                    return createPromise().promise;\n                },\n\n                accountManagement : function() {\n                    var accountUrl = kc.createAccountUrl();\n                    if (typeof accountUrl !== 'undefined') {\n                        window.location.href = accountUrl;\n                    } else {\n                        throw \"Not supported by the OIDC server\";\n                    }\n                    return createPromise().promise;\n                },\n\n                redirectUri: function(options, encodeHash) {\n                    if (arguments.length == 1) {\n                        encodeHash = true;\n                    }\n\n                    if (options && options.redirectUri) {\n                        return options.redirectUri;\n                    } else if (kc.redirectUri) {\n                        return kc.redirectUri;\n                    } else {\n                        return location.href;\n                    }\n                }\n            };\n        }\n\n        if (type == 'cordova') {\n            loginIframe.enable = false;\n            var cordovaOpenWindowWrapper = function(loginUrl, target, options) {\n                if (window.cordova && window.cordova.InAppBrowser) {\n                    // Use inappbrowser for IOS and Android if available\n                    return window.cordova.InAppBrowser.open(loginUrl, target, options);\n                } else {\n                    return window.open(loginUrl, target, options);\n                }\n            };\n\n            var shallowCloneCordovaOptions = function (userOptions) {\n                if (userOptions && userOptions.cordovaOptions) {\n                    return Object.keys(userOptions.cordovaOptions).reduce(function (options, optionName) {\n                        options[optionName] = userOptions.cordovaOptions[optionName];\n                        return options;\n                    }, {});\n                } else {\n                    return {};\n                }\n            };\n\n            var formatCordovaOptions = function (cordovaOptions) {\n                return Object.keys(cordovaOptions).reduce(function (options, optionName) {\n                    options.push(optionName+\"=\"+cordovaOptions[optionName]);\n                    return options;\n                }, []).join(\",\");\n            };\n\n            var createCordovaOptions = function (userOptions) {\n                var cordovaOptions = shallowCloneCordovaOptions(userOptions);\n                cordovaOptions.location = 'no';\n                if (userOptions && userOptions.prompt == 'none') {\n                    cordovaOptions.hidden = 'yes';\n                }\n                return formatCordovaOptions(cordovaOptions);\n            };\n\n            var getCordovaRedirectUri = function() {\n                return kc.redirectUri || 'http://localhost';\n            }\n\n            return {\n                login: async function(options) {\n                    var promise = createPromise();\n\n                    var cordovaOptions = createCordovaOptions(options);\n                    var loginUrl = await kc.createLoginUrl(options);\n                    var ref = cordovaOpenWindowWrapper(loginUrl, '_blank', cordovaOptions);\n                    var completed = false;\n\n                    var closed = false;\n                    var closeBrowser = function() {\n                        closed = true;\n                        ref.close();\n                    };\n\n                    ref.addEventListener('loadstart', function(event) {\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                            var callback = parseCallback(event.url);\n                            processCallback(callback, promise);\n                            closeBrowser();\n                            completed = true;\n                        }\n                    });\n\n                    ref.addEventListener('loaderror', function(event) {\n                        if (!completed) {\n                            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                                var callback = parseCallback(event.url);\n                                processCallback(callback, promise);\n                                closeBrowser();\n                                completed = true;\n                            } else {\n                                promise.setError();\n                                closeBrowser();\n                            }\n                        }\n                    });\n\n                    ref.addEventListener('exit', function(event) {\n                        if (!closed) {\n                            promise.setError({\n                                reason: \"closed_by_user\"\n                            });\n                        }\n                    });\n\n                    return promise.promise;\n                },\n\n                logout: function(options) {\n                    var promise = createPromise();\n\n                    var logoutUrl = kc.createLogoutUrl(options);\n                    var ref = cordovaOpenWindowWrapper(logoutUrl, '_blank', 'location=no,hidden=yes,clearcache=yes');\n\n                    var error;\n\n                    ref.addEventListener('loadstart', function(event) {\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                            ref.close();\n                        }\n                    });\n\n                    ref.addEventListener('loaderror', function(event) {\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                            ref.close();\n                        } else {\n                            error = true;\n                            ref.close();\n                        }\n                    });\n\n                    ref.addEventListener('exit', function(event) {\n                        if (error) {\n                            promise.setError();\n                        } else {\n                            kc.clearToken();\n                            promise.setSuccess();\n                        }\n                    });\n\n                    return promise.promise;\n                },\n\n                register : async function(options) {\n                    var promise = createPromise();\n                    var registerUrl = await kc.createRegisterUrl();\n                    var cordovaOptions = createCordovaOptions(options);\n                    var ref = cordovaOpenWindowWrapper(registerUrl, '_blank', cordovaOptions);\n                    ref.addEventListener('loadstart', function(event) {\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                            ref.close();\n                            var oauth = parseCallback(event.url);\n                            processCallback(oauth, promise);\n                        }\n                    });\n                    return promise.promise;\n                },\n\n                accountManagement : function() {\n                    var accountUrl = kc.createAccountUrl();\n                    if (typeof accountUrl !== 'undefined') {\n                        var ref = cordovaOpenWindowWrapper(accountUrl, '_blank', 'location=no');\n                        ref.addEventListener('loadstart', function(event) {\n                            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                                ref.close();\n                            }\n                        });\n                    } else {\n                        throw \"Not supported by the OIDC server\";\n                    }\n                },\n\n                redirectUri: function(options) {\n                    return getCordovaRedirectUri();\n                }\n            }\n        }\n\n        if (type == 'cordova-native') {\n            loginIframe.enable = false;\n\n            return {\n                login: async function(options) {\n                    var promise = createPromise();\n                    var loginUrl = await kc.createLoginUrl(options);\n\n                    universalLinks.subscribe('keycloak', function(event) {\n                        universalLinks.unsubscribe('keycloak');\n                        window.cordova.plugins.browsertab.close();\n                        var oauth = parseCallback(event.url);\n                        processCallback(oauth, promise);\n                    });\n\n                    window.cordova.plugins.browsertab.openUrl(loginUrl);\n                    return promise.promise;\n                },\n\n                logout: function(options) {\n                    var promise = createPromise();\n                    var logoutUrl = kc.createLogoutUrl(options);\n\n                    universalLinks.subscribe('keycloak', function(event) {\n                        universalLinks.unsubscribe('keycloak');\n                        window.cordova.plugins.browsertab.close();\n                        kc.clearToken();\n                        promise.setSuccess();\n                    });\n\n                    window.cordova.plugins.browsertab.openUrl(logoutUrl);\n                    return promise.promise;\n                },\n\n                register : async function(options) {\n                    var promise = createPromise();\n                    var registerUrl = await kc.createRegisterUrl(options);\n                    universalLinks.subscribe('keycloak' , function(event) {\n                        universalLinks.unsubscribe('keycloak');\n                        window.cordova.plugins.browsertab.close();\n                        var oauth = parseCallback(event.url);\n                        processCallback(oauth, promise);\n                    });\n                    window.cordova.plugins.browsertab.openUrl(registerUrl);\n                    return promise.promise;\n\n                },\n\n                accountManagement : function() {\n                    var accountUrl = kc.createAccountUrl();\n                    if (typeof accountUrl !== 'undefined') {\n                        window.cordova.plugins.browsertab.openUrl(accountUrl);\n                    } else {\n                        throw \"Not supported by the OIDC server\";\n                    }\n                },\n\n                redirectUri: function(options) {\n                    if (options && options.redirectUri) {\n                        return options.redirectUri;\n                    } else if (kc.redirectUri) {\n                        return kc.redirectUri;\n                    } else {\n                        return \"http://localhost\";\n                    }\n                }\n            }\n        }\n\n        throw 'invalid adapter type: ' + type;\n    }\n\n    const STORAGE_KEY_PREFIX = 'kc-callback-';\n\n    var LocalStorage = function() {\n        if (!(this instanceof LocalStorage)) {\n            return new LocalStorage();\n        }\n\n        localStorage.setItem('kc-test', 'test');\n        localStorage.removeItem('kc-test');\n\n        var cs = this;\n\n        /**\n         * Clears all values from local storage that are no longer valid.\n         */\n        function clearInvalidValues() {\n            const currentTime = Date.now();\n\n            for (const [key, value] of getStoredEntries()) {\n                // Attempt to parse the expiry time from the value.\n                const expiry = parseExpiry(value);\n\n                // Discard the value if it is malformed or expired.\n                if (expiry === null || expiry < currentTime) {\n                    localStorage.removeItem(key);\n                }\n            }\n        }\n\n        /**\n         * Clears all known values from local storage.\n         */\n        function clearAllValues() {\n            for (const [key] of getStoredEntries()) {\n                localStorage.removeItem(key);\n            }\n        }\n\n        /**\n         * Gets all entries stored in local storage that are known to be managed by this class.\n         * @returns {Array<[string, unknown]>} An array of key-value pairs.\n         */\n        function getStoredEntries() {\n            return Object.entries(localStorage).filter(([key]) => key.startsWith(STORAGE_KEY_PREFIX));\n        }\n\n        /**\n         * Parses the expiry time from a value stored in local storage.\n         * @param {unknown} value\n         * @returns {number | null} The expiry time in milliseconds, or `null` if the value is malformed.\n         */\n        function parseExpiry(value) {\n            let parsedValue;\n\n            // Attempt to parse the value as JSON.\n            try {\n                parsedValue = JSON.parse(value);\n            } catch (error) {\n                return null;\n            }\n\n            // Attempt to extract the 'expires' property.\n            if (isObject(parsedValue) && 'expires' in parsedValue && typeof parsedValue.expires === 'number') {\n                return parsedValue.expires;\n            }\n\n            return null;\n        }\n\n        cs.get = function(state) {\n            if (!state) {\n                return;\n            }\n\n            var key = STORAGE_KEY_PREFIX + state;\n            var value = localStorage.getItem(key);\n            if (value) {\n                localStorage.removeItem(key);\n                value = JSON.parse(value);\n            }\n\n            clearInvalidValues();\n            return value;\n        };\n\n        cs.add = function(state) {\n            clearInvalidValues();\n\n            const key = STORAGE_KEY_PREFIX + state.state;\n            const value = JSON.stringify({\n                ...state,\n                // Set the expiry time to 1 hour from now.\n                expires: Date.now() + (60 * 60 * 1000)\n            });\n\n            try {\n                localStorage.setItem(key, value);\n            } catch (error) {\n                // If the storage is full, clear all known values and try again.\n                clearAllValues();\n                localStorage.setItem(key, value);\n            }\n        };\n    };\n\n    var CookieStorage = function() {\n        if (!(this instanceof CookieStorage)) {\n            return new CookieStorage();\n        }\n\n        var cs = this;\n\n        cs.get = function(state) {\n            if (!state) {\n                return;\n            }\n\n            var value = getCookie(STORAGE_KEY_PREFIX + state);\n            setCookie(STORAGE_KEY_PREFIX + state, '', cookieExpiration(-100));\n            if (value) {\n                return JSON.parse(value);\n            }\n        };\n\n        cs.add = function(state) {\n            setCookie(STORAGE_KEY_PREFIX + state.state, JSON.stringify(state), cookieExpiration(60));\n        };\n\n        cs.removeItem = function(key) {\n            setCookie(key, '', cookieExpiration(-100));\n        };\n\n        var cookieExpiration = function (minutes) {\n            var exp = new Date();\n            exp.setTime(exp.getTime() + (minutes*60*1000));\n            return exp;\n        };\n\n        var getCookie = function (key) {\n            var name = key + '=';\n            var ca = document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1);\n                }\n                if (c.indexOf(name) == 0) {\n                    return c.substring(name.length, c.length);\n                }\n            }\n            return '';\n        };\n\n        var setCookie = function (key, value, expirationDate) {\n            var cookie = key + '=' + value + '; '\n                + 'expires=' + expirationDate.toUTCString() + '; ';\n            document.cookie = cookie;\n        }\n    };\n\n    function createCallbackStorage() {\n        try {\n            return new LocalStorage();\n        } catch (err) {\n        }\n\n        return new CookieStorage();\n    }\n\n    function createLogger(fn) {\n        return function() {\n            if (kc.enableLogging) {\n                fn.apply(console, Array.prototype.slice.call(arguments));\n            }\n        };\n    }\n}\n\nexport default Keycloak;\n\n/**\n * @param {ArrayBuffer} bytes\n * @see https://developer.mozilla.org/en-US/docs/Glossary/Base64#the_unicode_problem\n */\nfunction bytesToBase64(bytes) {\n    const binString = String.fromCodePoint(...bytes);\n    return btoa(binString);\n}\n\n/**\n * @param {string} message\n * @see https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest#basic_example\n */\nasync function sha256Digest(message) {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(message);\n\n    if (typeof crypto === \"undefined\" || typeof crypto.subtle === \"undefined\") {\n        throw new Error(\"Web Crypto API is not available.\");\n    }\n\n    return await crypto.subtle.digest(\"SHA-256\", data);\n}\n\n/**\n * @param {string} token\n */\nfunction decodeToken(token) {\n    const [header, payload] = token.split(\".\");\n\n    if (typeof payload !== \"string\") {\n        throw new Error(\"Unable to decode token, payload not found.\");\n    }\n\n    let decoded;\n\n    try {\n        decoded = base64UrlDecode(payload);\n    } catch (error) {\n        throw new Error(\"Unable to decode token, payload is not a valid Base64URL value.\", { cause: error });\n    }\n\n    try {\n        return JSON.parse(decoded);\n    } catch (error) {\n        throw new Error(\"Unable to decode token, payload is not a valid JSON value.\", { cause: error });\n    }\n}\n\n/**\n * @param {string} input\n */\nfunction base64UrlDecode(input) {\n    let output = input\n        .replaceAll(\"-\", \"+\")\n        .replaceAll(\"_\", \"/\");\n\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"Input is not of the correct length.\");\n    }\n\n    try {\n        return b64DecodeUnicode(output);\n    } catch (error) {\n        return atob(output);\n    }\n}\n\n/**\n * @param {string} input\n */\nfunction b64DecodeUnicode(input) {\n    return decodeURIComponent(atob(input).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n\n        return \"%\" + code;\n    }));\n}\n\n/**\n * Check if the input is an object that can be operated on.\n * @param {unknown} input\n */\nfunction isObject(input) {\n    return typeof input === 'object' && input !== null;\n}\n"],"names":["Keycloak","config","this","Error","isObject","requiredProperties","property","adapter","callbackStorage","kc","refreshQueue","loginIframe","enable","callbackList","interval","didInitialize","useNonce","logInfo","createLogger","console","info","logWarn","warn","generateCodeVerifier","len","alphabet","randomData","crypto","getRandomValues","Uint8Array","generateRandomData","chars","Array","i","charCodeAt","length","String","fromCharCode","apply","generateRandomString","async","generatePkceChallenge","pkceMethod","codeVerifier","TypeError","bytes","binString","fromCodePoint","btoa","bytesToBase64","message","data","TextEncoder","encode","subtle","digest","sha256Digest","replace","getRealmUrl","authServerUrl","charAt","encodeURIComponent","realm","processCallback","oauth","promise","code","error","prompt","timeLocal","Date","getTime","onActionUpdate","error_description","login","loginOptions","errorData","onAuthError","setError","setSuccess","flow","access_token","id_token","authSuccess","params","url","endpoints","token","req","XMLHttpRequest","open","setRequestHeader","clientId","redirectUri","pkceCodeVerifier","withCredentials","onreadystatechange","readyState","status","tokenResponse","JSON","parse","responseText","scheduleCheckIframe","send","accessToken","refreshToken","idToken","fulfillPromise","setToken","idTokenParsed","nonce","storedNonce","clearToken","onAuthSuccess","fileLoaded","xhr","responseURL","startsWith","tokenTimeoutHandle","clearTimeout","refreshTokenParsed","decodeToken","tokenParsed","sessionId","sid","authenticated","subject","sub","realmAccess","realm_access","resourceAccess","resource_access","timeSkew","Math","floor","iat","onTokenExpired","expiresIn","round","setTimeout","createUUID","randomUUID","parseCallback","supportedParams","push","newUrl","parsed","queryIndex","indexOf","fragmentIndex","responseMode","substring","parseCallbackParams","paramsString","oauthParams","state","parseCallbackUrl","oauthState","get","valid","p","split","result","key","slice","createPromise","resolve","reject","Promise","setupCheckLoginIframe","iframe","document","createElement","onload","authUrl","authorize","iframeOrigin","window","location","origin","protocol","hostname","port","src","checkSessionIframe","setAttribute","style","display","body","appendChild","addEventListener","event","contentWindow","source","callbacks","splice","checkLoginIframe","then","unchanged","msg","postMessage","loadAdapter","type","options","assign","createLoginUrl","logout","logoutMethod","createLogoutUrl","logoutUrl","response","fetch","method","headers","URLSearchParams","id_token_hint","client_id","post_logout_redirect_uri","redirected","href","ok","reload","register","createRegisterUrl","accountManagement","accountUrl","createAccountUrl","encodeHash","cordovaOpenWindowWrapper","loginUrl","target","cordova","InAppBrowser","createCordovaOptions","userOptions","cordovaOptions","Object","keys","reduce","optionName","shallowCloneCordovaOptions","hidden","join","formatCordovaOptions","getCordovaRedirectUri","ref","completed","closed","closeBrowser","close","reason","registerUrl","universalLinks","subscribe","unsubscribe","plugins","browsertab","openUrl","globalThis","isSecureContext","init","initOptions","LocalStorage","err","CookieStorage","createCallbackStorage","Cordova","checkLoginIframeInterval","onLoad","loginRequired","responseType","silentCheckSsoRedirectUri","silentCheckSsoFallback","enableLogging","scope","acrValues","messageReceiveTimeout","initPromise","onReady","catch","configPromise","configUrl","setupOidcEndoints","oidcConfiguration","authorization_endpoint","token_endpoint","end_session_endpoint","check_session_iframe","userinfo","userinfo_endpoint","thirdPartyCookiesIframe","oidcProviderConfigUrl","oidcProvider","loadConfig","doLogin","locale","checkSsoSilently","ifrm","messageCallback","removeChild","removeEventListener","processInit","callback","history","replaceState","updateToken","timeout","errorMessage","timeoutHandle","timeoutPromise","race","finally","applyTimeoutToPromise","check3pCookiesSupported","baseUrl","callbackState","action","requestedAcr","claims","maxAge","loginHint","idpHint","acr","claimsParameter","stringify","pkceChallenge","cause","add","undefined","hasRealmRole","role","access","roles","hasResourceRole","resource","loadUserProfile","profile","loadUserInfo","userInfo","isTokenExpired","minValidity","ceil","isNaN","exec","onAuthRefreshSuccess","pop","onAuthRefreshError","onAuthLogout","STORAGE_KEY_PREFIX","localStorage","setItem","removeItem","clearInvalidValues","currentTime","now","value","getStoredEntries","expiry","parseExpiry","entries","filter","parsedValue","expires","getItem","clearAllValues","cs","getCookie","setCookie","cookieExpiration","minutes","exp","setTime","name","ca","cookie","c","expirationDate","toUTCString","fn","prototype","call","arguments","header","payload","decoded","input","output","replaceAll","decodeURIComponent","atob","m","toString","toUpperCase","b64DecodeUnicode","base64UrlDecode"],"mappings":"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","x_google_ignoreList":[0]}